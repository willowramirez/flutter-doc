# flutter 跨平台视频不播放问题

## 描述

在 Flutter web 端可以正常播放视频时，在 Android 和 iOS 端无法播放视频。报找不到资源的错误。

## 排查过程

1. 检查资源是否被打入包内，在执行完`flutter pub get`之后，会将静态资源打入`build/app/intermediates/assets/debug/flutter_assets/assets/videos`、`build/ios/Debug-iphonesimulator/Runner.app/Frameworks/App.framework/flutter_assets/assets/videos`、`build/ios/iphonesimulator/Runner.app/Frameworks/App.framework/flutter_assets/assets/videos`中，这里要结合[pubspec.yaml](../pubspec.yaml)中的 assets 配置。
2. 尝试过用VideoPlayerController的其他 API，尝试过用 dart.io，尝试过用三方库协助读写本地文件，均无法播放。

## 解决

在 web 中，静态文件是可以不带 assets 前缀的，而在 Android 和 iOS 中，静态文件需要带上 assets 前缀，否则会找不到资源。所以将整个项目在用到静态资源路径的地方都加上了一层`assets/`目录，这样三端都可以正常播放。

## 以下是用本地资源需要的权限，但是否一定要加，待完整验证

```ios
ios/Runner/Info.plist

<key>NSAppleMusicUsageDescription</key>
<string>我们需要访问您的音乐库来播放视频。</string>
<key>NSPhotoLibraryUsageDescription</key>
<string>我们需要访问您的照片库来播放视频。</string>
```
